{% extends "base.html" %}
{% load i18n %}
{% block title %}GBB {{ year }} {% trans "大会結果" %} - GBBINFO-JPN{% endblock %}
{% block twitter_title %}GBB {{ year }} {% trans "大会結果" %} - GBBINFO-JPN{% endblock %}
{% block og_title %}GBB {{ year }} {% trans "大会結果" %} - GBBINFO-JPN{% endblock %}
{% block og_url %}https://gbbinfo-jpn.onrender.com/{{ year }}/result{% endblock %}
{% block canonical %}https://gbbinfo-jpn.onrender.com/{{ year }}/result{% endblock %}
{% block content %}
<h1>GBB {{ year }} {% trans "大会結果" %}</h1>

{% if all_category %}
  <form method="get" action="/{{ year }}/result" class="participants_form">
    <label for="category">{% trans "部門選択" %}</label>
    <select name="category" id="category" class="filter-select" onchange="this.form.submit()">
      {% for c in all_category %}
        <option value="{{ c }}" {% if category == c %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>
  </form>
{% endif %}

{% if result_type == "tournament" %}
  {% for round, data in result_data.items %}
    <h2>{{ category }} - {{ round }}</h2>
    <table>
      <thead>
        <tr>
          <th style="width: 50%; color: rgb(255, 100, 23);">{% trans "勝ち" %}</th>
          <th style="width: 10%;"></th>
          <th style="width: 40%;">{% trans "負け" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for match in data %}
          <tr>
            <td class="winner">{{ match.winner }}</td>
            <td>vs</td>
            <td>{{ match.loser }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}
{% elif result_type == "ranking" %}
  {% for round, data in result_data.items %}
    <h2>{{ category }} - {{ round }}</h2>
    <table>
      <thead>
        <tr>
          <th style="width: 20%;">{% trans "順位" %}</th>
          <th style="width: 80%;">{% trans "名前" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for result in data %}
          <tr>
            <td>{{ result.rank }}</td>
            <td>{{ result.name }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}
{% else %}
  <p>{% trans "～発表次第更新～" %}</p>
{% endif %}

{% if all_category %}
  <form method="GET" action="/{{ year }}/result" class="participants_form">
    <label for="category">{% trans "部門選択" %}</label>
    <select name="category" id="category" class="filter-select" onchange="this.form.submit()">
      {% for c in all_category %}
        <option value="{{ c }}" {% if category == c %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>
  </form>
{% endif %}

<form method="GET" class="participants_form">
<label for="year">{% trans "その他の年度を確認：" %}</label>
<select name="year" id="year" class="filter-select" onchange="redirect_year('result')">
  {% for y in available_years %}
    <option value="{{ y }}" {% if year == y %}selected{% endif %}>{{ y }}</option>
  {% endfor %}
</select>
</form>

<div class="button-container">
  <a href="/{{ year }}/rule"><button type="button">{% trans "出場権詳細" %}</button></a>
  <a href="/{{ year }}/rule"><button type="button">{% trans "ルール & 審査員" %}</button></a>
  <a href="/{{ year }}/participants"><button>{% trans "Wildcard結果" %} & {% trans "出場者" %}</button></a>
</div>

{% endblock %}
