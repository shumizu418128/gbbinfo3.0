{% extends "base.html" %}

{% block title %}GBB {{ year }} {{_("Wildcard結果 & 出場者")}} - GBBINFO-JPN{% endblock %}
{% block twitter_title %}GBB {{ year }} {{_("Wildcard結果 & 出場者")}} - GBBINFO-JPN{% endblock %}
{% block og_title %}GBB {{ year }} {{_("Wildcard結果 & 出場者")}} - GBBINFO-JPN{% endblock %}
{% block og_url %}https://gbbinfo-jpn.onrender.com/{{ year }}/participants{% endblock %}
{% block canonical %}https://gbbinfo-jpn.onrender.com/{{ year }}/participants{% endblock %}
{% block content %}

<h1>GBB {{ year }} {{_("Wildcard結果 & 出場者")}}</h1>

{% if is_latest_year is true %}
  <div style="text-align: center;">
    <p>{{_("最終更新")}}<br>{{ last_updated }}</p>
  </div>
{% endif %}

{% if not all_category %}
  <p style="text-align: center;">{{_("～発表次第更新～")}}</p>
  <div style="height: 100px;"></div>
{% else %}
  {% include "includes/participants_form.html" %}

  {% if ticket_class == "wildcard" %}
    <h2>{{ category }} {{_("Wildcard結果")}}</h2>
  {% elif ticket_class == "seed_right" %}
    <h2>{{ category }} {{_("シード権獲得者")}}</h2>
  {% elif ticket_class == "all" %}
    <h2>{{ category }} {{_("全出場者一覧")}}</h2>
  {% endif %}

  {% if cancel == "hide" %}
    <div class="post-it"><p>{{_("出場者のみ")}}</p></div>
  {% elif cancel == "only_cancelled" %}
    <div class="post-it"><p>{{_("辞退者のみ")}}</p></div>
  {% elif cancel == "show" %}
    <div class="post-it"><p>{{_("出場者 & 辞退者を表示")}}</p></div>
  {% endif %}

  {% if participants %}
    <table>
      <thead>
        <tr>
          <th style="width: 33%;">{{_("名前")}}</th>
          <th style="width: 34%;">{{_("国")}}</th>
          <th style="width: 33%;">{{_("出場権")}}</th>
        </tr>
      </thead>
      <tbody>
        {% for participant in participants %}
          <tr>
            {% if participant.is_cancelled %}
              <td>
                【{{_("辞退")}}】<br>
                <a href="/others/participant_detail?id={{ participant.id }}&mode={% if participant.is_team %}team{% else %}single{% endif %}">{{ participant.name }}</a>
              </td>
              <td {% if participant.country|length > 5 %} style="font-size: 12px;" {% endif %}>
                <s>{{ participant.country }}</s>
              </td>
              <td {% if participant.ticket_class|length > 11 %} style="font-size: 12px;" {% endif %}>
                <s>{{ participant.ticket_class }}</s>
              </td>
            {% else %}
              {% if participant.name == "???" %}
                <td>{{ participant.name }}</td>
              {% else %}
                <td>
                  <a href="/others/participant_detail?id={{ participant.id }}&mode={% if participant.is_team %}team{% else %}single{% endif %}">{{ participant.name }}</a>
                </td>
              {% endif %}
              <td {% if participant.country|length > 5 %} style="font-size: 12px;" {% endif %}>
                {{ participant.country }}
              </td>
              <td {% if participant.ticket_class|length > 11 %} style="font-size: 12px;" {% endif %}>
                {{ participant.ticket_class }}
              </td>
            {% endif %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p style="text-align: center;">{{_("～発表次第更新～")}}</p>
    <div style="height: 200px;"></div>
  {% endif %}
    {% include "includes/participants_form.html" %}
{% endif %}
<div style="margin: 40px 0;"></div>

<div style="text-align: center;">
  <p>Wildcardを見る会<br>Wildcard結果発表を見る会<br>ビト森にて随時開催中！</p>
</div>

<div class="button-container">
  <a href="/{{ year }}/bitomori"><button style="background-image: url('/static/images/button/bitomori.webp');" class="bg-pic">
    <svg class="bg-pic" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#0044CC"><path d="m380-340 280-180-280-180v360Zm-60 220v-80H160q-33 0-56.5-23.5T80-280v-480q0-33 23.5-56.5T160-840h640q33 0 56.5 23.5T880-760v480q0 33-23.5 56.5T800-200H640v80H320Z"/></svg>
    <span class="button-text-with-icon">ビト森 GBB鑑賞会</span>
  </button></a>
  <a href="/{{year}}/rule"><button>{{_("出場権詳細")}}</button></a>
  <a href="/{{year}}/rule?scroll=result_date"><button>{{_("Wildcard結果発表日")}}</button></a>
  <a href="/{{ year }}/wildcards"><button>{{_("Wildcard一覧")}}</button></a>
</div>

<form method="GET" class="participants_form">
  <label for="year">{{_("その他の年度を確認：")}}</label>
  <select name="year" id="year" class="filter-select" onchange="redirect_year('participants')">
    {% for y in available_years %}
      <option value="{{ y }}" {% if year == y %}selected{% endif %}>{{ y }}</option>
    {% endfor %}
  </select>
</form>

{% if all_category %}
  <h2 name="search_participants">{{_("出場者検索")}}</h2>
  <p>GBB {{ year }} {{_("出場者名を検索できます")}}<br>{{_("半角英数字推奨")}}</p>
  <form id="search-participants" class="search-container" onsubmit="searchParticipants({{ year }}, event)">
    <input type="text" name="keyword" id="keyword" value="{{ value }}" placeholder="{{_("出場者検索")}}" pattern="[a-zA-Z0-9\s]*" oninput="this.value = this.value.replace(/[^a-zA-Z0-9\s]/g, '')">
    <button type="submit"></button>
  </form>
  <div id="loading" class="loading"></div>

  <h3 id="search-participants-result-h3">{{_("検索結果")}}</h3>
  <div id="exact-match-message" style="text-align: center;"></div>
  <table>
    <thead>
      <tr>
        <th style="width: 33%;">{{_("名前")}}</th>
        <th style="width: 34%;">{{_("部門")}}</th>
        <th style="width: 33%;">{{_("出場権")}}</th>
      </tr>
    </thead>
    <tbody id="participants-search-result"></tbody>
  </table>


  <h2>{{_("出場者世界地図")}}</h2>
  <p>GBB {{ year }} {{_("全出場者を地図にマッピングしました。")}}<br>{{_("国旗をタップorクリックすると、詳細を確認できます。")}}</p>
  <iframe src="/{{ year }}/world_map" width="100%" height="400px" frameborder="0"></iframe>
{% endif %}

<div class="button-container">
  <a href="/{{ year }}/rule"><button type="button">GBB {{ year }} {{_("ルール")}}</button></a>
  <a href="/{{ year }}/cancels"><button type="button">GBB {{ year }} {{_("辞退者一覧")}}</button></a>
</div>
<div class="button-container">
  <a href="/{{ year - 1 }}/participants"><button type="button">GBB {{ year - 1 }} {{_("Wildcard結果 & 出場者")}}</button></a>
</div>

{% endblock %}
